# –†–µ–∑—é–º–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ FileTreeView

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

### 1. **–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**
- `SimpleCustomTree` ‚Üí `FileTreeView`
- –ë–æ–ª–µ–µ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω–æ–µ –∏ –ø–æ–Ω—è—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ

### 2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–µ–π (SRP)**
- `TreeViewTheme` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞
- `TreeItem` - –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö
- `TreeItemRenderer` - –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- `TreeEventController` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
- `FileTreeView` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

### 3. **–°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö (OCP)**
- `TreeDataProvider` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- `FileSystemDataProvider` - —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
- `GitDataProvider` - Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

### 4. **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è (DRY)**
- –£–¥–∞–ª–µ–Ω –¥—É–±–ª–∏—Ä—É—é—â–∏–π `CustomTreeWidget`
- –û–±—â–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã

### 5. **–£–ø—Ä–æ—â–µ–Ω–∏–µ (KISS)**
- –ü—Ä–æ—Å—Ç—ã–µ, –ø–æ–Ω—è—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

## üìÅ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

```
lib/ui/widgets/
‚îú‚îÄ‚îÄ file_tree_view.rb          # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îî‚îÄ‚îÄ tree_data_provider.rb      # –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

test/
‚îî‚îÄ‚îÄ file_tree_view_test.rb     # –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

REFACTORING.md                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
SUMMARY.md                     # –≠—Ç–æ —Ä–µ–∑—é–º–µ
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

**–ë—ã–ª–æ:**
```ruby
@tree = SimpleCustomTree.new
@tree.define_singleton_method(:open_file) { |path| block.call(path) }
```

**–°—Ç–∞–ª–æ:**
```ruby
@tree = FileTreeView.new
@tree.on_file_selected { |path| block.call(path) }
```

## üöÄ –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å

### –ù–æ–≤—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã:
```ruby
class DatabaseDataProvider < TreeDataProvider
  def get_items(path)
    # –î–∞–Ω–Ω—ã–µ –∏–∑ –ë–î
  end
end

tree = FileTreeView.new(DatabaseDataProvider.new)
```

### –ù–æ–≤—ã–µ —Ç–µ–º—ã:
```ruby
class DarkTheme < TreeViewTheme
  COLORS = { background: [0x2d2d2d, 0.97] }
end
```

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- ‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ
- ‚úÖ Callback —Å–∏—Å—Ç–µ–º–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å—Ç–∞–ª:
- **–ú–æ–¥—É–ª—å–Ω—ã–º** - –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å
- **–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–º** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º** - —á–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º** - —Ä–∞–∑–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö 