# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–Ω–µ–ª–µ–π GTKRB

## –û–±–∑–æ—Ä

–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–Ω–µ–ª–µ–π –≤ GTKRB –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≥–∏–±–∫—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤ –ø–∞–Ω–µ–ª—è—Ö: —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞, —Ç–µ—Ä–º–∏–Ω–∞–ª, —Ñ–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∏ –¥—Ä—É–≥–∏–µ.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. BasePanel (–±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å)

–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –ø–∞–Ω–µ–ª–µ–π:

```ruby
class BasePanel
  attr_reader :panel_id, :panel_type
  
  # –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã
  def setup_ui        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ UI
  def get_title       # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–∞–Ω–µ–ª–∏
  def can_close?      # –ú–æ–∂–Ω–æ –ª–∏ –∑–∞–∫—Ä—ã—Ç—å
  def has_unsaved_changes? # –ï—Å—Ç—å –ª–∏ –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
  def save            # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
  def focus           # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–æ–∫—É—Å
end
```

### 2. –¢–∏–ø—ã –ø–∞–Ω–µ–ª–µ–π

#### EditorPanel
- –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
- –ò—Å—Ç–æ—Ä–∏—è —Ñ–∞–π–ª–æ–≤
- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤

#### TerminalPanel  
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª VTE
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
- –¢–µ–º–Ω–∞—è —Ç–µ–º–∞

#### FileManagerPanel
- –§–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å –∏–∫–æ–Ω–∫–∞–º–∏
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é
- –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤/–ø–∞–ø–æ–∫
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º

### 3. PanelFactory

–§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–Ω–µ–ª–µ–π:

```ruby
# –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–Ω–µ–ª–∏ –ø–æ —Ç–∏–ø—É
panel = PanelFactory.create_panel(:editor)
panel = PanelFactory.create_panel(:terminal, working_dir: "/path")
panel = PanelFactory.create_panel(:file_manager, root_dir: "/path")

# –£–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã
panel = PanelFactory.create_editor_with_file("file.rb")
panel = PanelFactory.create_terminal_in_dir("/path")
panel = PanelFactory.create_panel_for_file("file.rb")
```

### 4. PanelManager

–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–Ω–µ–ª–µ–π:

```ruby
manager = PanelManager.new(container)

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–Ω–µ–ª–µ–π
manager.create_editor_panel
manager.create_terminal_panel
manager.create_file_manager_panel

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
manager.split_horizontal
manager.split_vertical
manager.close_panel(panel)
manager.enter_grid_mode
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–æ–≤

```
BasePanel (abstract)
‚îú‚îÄ‚îÄ EditorPanel
‚îú‚îÄ‚îÄ TerminalPanel
‚îú‚îÄ‚îÄ FileManagerPanel
‚îî‚îÄ‚îÄ ... (–¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã)

PanelFactory
‚îú‚îÄ‚îÄ create_panel(type, options)
‚îú‚îÄ‚îÄ create_editor_with_file(path)
‚îú‚îÄ‚îÄ create_terminal_in_dir(dir)
‚îî‚îÄ‚îÄ create_panel_for_file(path)

PanelManager
‚îú‚îÄ‚îÄ @panels: Array<BasePanel>
‚îú‚îÄ‚îÄ @active_panel: BasePanel
‚îú‚îÄ‚îÄ @container: SplitContainer
‚îî‚îÄ‚îÄ callbacks system
```

## –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π

–ö–∞–∂–¥–∞—è –ø–∞–Ω–µ–ª—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç callbacks:

```ruby
panel.on_focus { |panel| ... }
panel.on_modified { ... }
panel.on_close { |panel| ... }
panel.on_split_horizontal { |panel| ... }
panel.on_split_vertical { |panel| ... }
panel.on_save { |panel| ... }
panel.on_history { |panel| ... }
```

## –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–Ω–æ–ø–æ–∫

–ö–∞–∂–¥–∞—è –ø–∞–Ω–µ–ª—å –∏–º–µ–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏:

### EditorPanel
- **‚äû** Focus - —Ñ–æ–∫—É—Å –Ω–∞ –ø–∞–Ω–µ–ª–∏
- **‚ùô** Split Vertical - —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ
- **‚ïê** Split Horizontal - —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ
- **‚è∑** File History - –∏—Å—Ç–æ—Ä–∏—è —Ñ–∞–π–ª–æ–≤
- **üíæ** Save - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
- **‚úó** Close - –∑–∞–∫—Ä—ã—Ç—å

### TerminalPanel
- **‚äû** Focus - —Ñ–æ–∫—É—Å –Ω–∞ –ø–∞–Ω–µ–ª–∏
- **‚ùô** Split Vertical - —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ
- **‚ïê** Split Horizontal - —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ
- **üîÑ** Restart - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª
- **üìù** New Editor - —Å–æ–∑–¥–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä
- **‚úó** Close - –∑–∞–∫—Ä—ã—Ç—å

### FileManagerPanel
- **‚äû** Focus - —Ñ–æ–∫—É—Å –Ω–∞ –ø–∞–Ω–µ–ª–∏
- **‚ùô** Split Vertical - —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ
- **‚ïê** Split Horizontal - —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ
- **üîÑ** Refresh - –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
- **üìù** New Editor - —Å–æ–∑–¥–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä
- **‚úó** Close - –∑–∞–∫—Ä—ã—Ç—å

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ –ø–∞–Ω–µ–ª–∏

1. –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å, –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π –æ—Ç `BasePanel`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã
3. –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø –≤ `PanelFactory`
4. –î–æ–±–∞–≤–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ callbacks –≤ `PanelManager`

–ü—Ä–∏–º–µ—Ä:

```ruby
class ImageViewerPanel < BasePanel
  def initialize(image_path)
    super(:image_viewer)
    @image_path = image_path
  end

  def setup_ui
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  end

  def get_title
    "Image: #{File.basename(@image_path)}"
  end
end
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ PanelFactory

```ruby
def self.create_panel(type, options = {})
  case type
  when :image_viewer
    ImageViewerPanel.new(options[:image_path])
  # ... –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã
  end
end
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SplitContainer

–ü–∞–Ω–µ–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—Ç—Å—è —Å —Å–∏—Å—Ç–µ–º–æ–π —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è:

```ruby
@container.split_horizontal(panel1, panel2)
@container.split_vertical(panel1, panel2)
@container.set_grid_layout(panels)
@container.replace_panel(old_panel, new_panel)
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–ì–∏–±–∫–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –ø–∞–Ω–µ–ª–µ–π
2. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π —Ç–∏–ø –ø–∞–Ω–µ–ª–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º
3. **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ** - –æ–±—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö –ø–∞–Ω–µ–ª–µ–π
4. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ø—Ä–æ—Å—Ç–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
5. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** - –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ –±–∞–∑–æ–≤–æ–º –∫–ª–∞—Å—Å–µ

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å —Å—Ç–∞—Ä–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–°—Ç–∞—Ä–∞—è `EditorPane` –∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞:
- `EditorPanel` - –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
- `TerminalPanel` - –¥–ª—è —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
- `BasePanel` - –±–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

–°—Ç–∞—Ä—ã–π `EditorManager` –∑–∞–º–µ–Ω–µ–Ω –Ω–∞:
- `PanelManager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–Ω–µ–ª—è–º–∏
- `PanelFactory` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–Ω–µ–ª–µ–π

–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å API –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π. 